@page "/"

@* Intro *@
@if (!started)
{
    <div class="intro-screen">
        <h1 class="app-title">Weekend Energy Tracker</h1>
        <button class="btn btn-primary btn-lg" @onclick="() => started = true">Start</button>
    </div>
}
else
{
    <div class="container py-4 main-ui">




<datalist id="hourMarks">
    @for (int i = 0; i <= 24; i++)
    {
        <option value="@i"></option>
    }
</datalist>

<div class="day-log">
    <h4>Saturday</h4>
    @foreach (var cat in Categories)
    {
        <label>@cat</label>
        <input type="range"
               min="0" max="24" step="1"
               list="hourMarks"
               @bind="SaturdayHours[cat]" />
        <span>@SaturdayHours[cat] hrs</span>
    }
    <p><b>Total:</b> @GetTotalHours(SaturdayHours) hrs</p>
</div>

<div class="day-log">
    <h4>Sunday</h4>
    @foreach (var cat in Categories)
    {
        <label>@cat</label>
        <input type="range"
               min="0" max="24" step="1"
               list="hourMarks"
               @bind="SundayHours[cat]" />
        <span>@SundayHours[cat] hrs</span>
    }
    <p><b>Total:</b> @GetTotalHours(SundayHours) hrs</p>
</div>

<button @onclick="ShowMoodSummary">Show Mood Summary</button>
@if (!string.IsNullOrEmpty(MoodSummary))
{
    <div class="mood-summary">
        <h4>Your Mood Summary:</h4>
        <p>@MoodSummary</p>
    </div>
}

 </div>
 }

@code {
    private bool started = false;

    private string[] Categories = { "Creative", "Rest", "Social", "Errands" };
    private Dictionary<string, int> SaturdayHours = new();
    private Dictionary<string, int> SundayHours = new();
    private string MoodSummary;

    protected override void OnInitialized()
    {
        foreach (var c in Categories)
        {
            SaturdayHours[c] = 0;
            SundayHours[c] = 0;
        }
    }

    private int GetTotalHours(Dictionary<string, int> d)
      => d.Values.Sum();

    private void ShowMoodSummary()
    {
        var total = GetTotalHours(SaturdayHours) + GetTotalHours(SundayHours);
        if (total == 0)
        {
            MoodSummary = "Please log some hours first.";
            return;
        }
        var combined = Categories.ToDictionary(
          cat => cat,
          cat => SaturdayHours[cat] + SundayHours[cat]
        );
        var pct = combined.ToDictionary(
          kv => kv.Key,
          kv => (double)kv.Value / total * 100
        );

        if (pct["Rest"] > 50) MoodSummary = "🛌 Cozy Recharge: You prioritized rest.";
        else if (pct["Creative"] > 40) MoodSummary = "🎨 Flow Mode: You spent a lot of time being creative.";
        else if (pct["Social"] > 40) MoodSummary = "💬 Sparked Up: Social connections fueled your weekend.";
        else if (pct["Creative"] + pct["Rest"] > 70)
            MoodSummary = "🌙 Chill Creator: Creativity + rest in harmony.";
        else MoodSummary = "⚠️ Scattered Energy: Your weekend was varied.";
    }
}
